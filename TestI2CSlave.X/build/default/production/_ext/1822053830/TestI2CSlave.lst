MPASM 5.64  /PROJECTS/I2CTEST/TESTI2CSLAVE.A   11-9-2015  15:32:32         PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00001 ;====================================================================================================
                      00002 ;
                      00003 ;   Filename:   TestI2CSlave.asm
                      00004 ;   Date:       11/5/2015
                      00005 ;   File Version:       1.0d2
                      00006 ;
                      00007 ;    Author:    David M. Flynn
                      00008 ;    Company:   Oxford V.U.E., Inc.
                      00009 ;    E-Mail:    dflynn@oxfordvue.com
                      00010 ;    Web Site:  http://www.oxfordvue.com/
                      00011 ;
                      00012 ;====================================================================================================
                      00013 ;    I2C Example for PIC12F1822 sample projects
                      00014 ;
                      00015 ;    History:
                      00016 ;
                      00017 ; 1.0d2  11/5/2015      More testing.
                      00018 ; 1.0d1  4/23/2015      First code
                      00019 ;
                      00020 ;====================================================================================================
                      00021 ; Options
                      00022 ;
                      00023 ;====================================================================================================
                      00024 ;====================================================================================================
                      00025 ; What happens next:
                      00026 ;
                      00027 ;   The system LED blinks once per second
                      00028 ;
                      00029 ;
                      00030 ;  Communications:
                      00031 ;     Send state of SW_1 to remote.
                      00032 ;     Receive remote SW_1 and light LED_1
                      00033 ;
                      00034 ;
                      00035 ;====================================================================================================
                      00036 ;
                      00037 ;  Pin 1 VDD (+5V)              +5V
                      00038 ;  Pin 2 RA5            LED_1 (Active high output)
                      00039 ;  Pin 3 RA4            System LED Active Low/Center switch Active Low
                      00040 ;  Pin 4 RA3/MCLR*/Vpp (Input only)     SW_1  (Active Low input)
                      00041 ;  Pin 5 RA2            SDA
                      00042 ;  Pin 6 RA1/ICSPCLK            SCL
                      00043 ;  Pin 7 RA0/ICSPDAT/AN0
                      00044 ;  Pin 8 VSS (Ground)           Ground
                      00045 ;
                      00046 ;====================================================================================================
                      00047 ;
                      00048 ;
                      00049         list    p=12f1822,r=hex,w=0     ; list directive to define processor
                      00050 ;
                      00001         LIST
                      00002 
                      00003 ;==========================================================================
MPASM 5.64  /PROJECTS/I2CTEST/TESTI2CSLAVE.A   11-9-2015  15:32:32         PAGE  2


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00004 ; MPASM PIC12F1822 processor include
                      00005 ;       
                      00006 ; (c) Copyright 1999-2014 Microchip Technology, All rights reserved
                      00007 ;==========================================================================
                      00008 
                      01039         LIST
                      00053         list
                      00054 ;
Message[303]: Program word too large.  Truncated to core size. (EFA4)
8007   2FA4           00055         __CONFIG _CONFIG1,_FOSC_INTOSC & _WDTE_OFF & _MCLRE_OFF & _IESO_OFF
                      00056 ;
                      00057 ;
                      00058 ;
                      00059 ; INTOSC oscillator: I/O function on CLKIN pin
                      00060 ; WDT disabled
                      00061 ; PWRT disabled
                      00062 ; MCLR/VPP pin function is digital input
                      00063 ; Program memory code protection is disabled
                      00064 ; Data memory code protection is disabled
                      00065 ; Brown-out Reset enabled
                      00066 ; CLKOUT function is disabled. I/O or oscillator function on the CLKOUT pin
                      00067 ; Internal/External Switchover mode is disabled
                      00068 ; Fail-Safe Clock Monitor is enabled
                      00069 ;
Message[303]: Program word too large.  Truncated to core size. (DEFF)
8008   1EFF           00070         __CONFIG _CONFIG2,_WRT_OFF & _PLLEN_OFF & _LVP_OFF
                      00071 ;
                      00072 ; Write protection off
                      00073 ; 4x PLL disabled
                      00074 ; Stack Overflow or Underflow will cause a Reset
                      00075 ; Brown-out Reset Voltage (Vbor), low trip point selected.
                      00076 ; Low-voltage programming Disabled ( allow MCLR to be digital in )
                      00077 ;  *** must set apply Vdd before Vpp in ICD 3 settings ***
                      00078 ;
                      00079 ; '__CONFIG' directive is used to embed configuration data within .asm file.
                      00080 ; The lables following the directive are located in the respective .inc file.
                      00081 ; See respective data sheet for additional information on configuration word.
                      00082 ;
  0000                00083         constant        oldCode=0
  0000                00084         constant        useRS232=0
  0001                00085         constant        useI2CISR=1
  0001                00086         constant        useI2CWDT=1
                      00087 ;
                      00088 #Define _C      STATUS,C
                      00089 #Define _Z      STATUS,Z
                      00090 ;
                      00091 ;
                      00092 ;
                      00093 ;====================================================================================================
                      00096         list
                      00097 ;
                      00098 ;    Port A bits
  000000CF            00099 PortADDRBits    EQU     b'11001111'
MPASM 5.64  /PROJECTS/I2CTEST/TESTI2CSLAVE.A   11-9-2015  15:32:32         PAGE  3

F1822 Macros
LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00100 #Define SystemLED       LATA,4  ;Output: 0=LED ON, Input: 0 = Switch Pressed
                      00101 #Define SysLEDTrisBit   TRISA,4
                      00102 #Define SW1BtnBit       PORTA,3
                      00103 #Define LED1Bit LATA,5
                      00104 ;
  00000000            00105 PortAValue      EQU     b'00000000'
                      00106 ;
                      00107 ;====================================================================================================
                      00108 ;====================================================================================================
                      00109 ;
                      00110 ;Constants
  000000FF            00111 All_In  EQU     0xFF
  00000000            00112 All_Out EQU     0x00
                      00113 ;
  000000B2            00114 TMR0Val EQU     0xB2    ;0xB2=100Hz, 0.000128S/Count
  00000064            00115 LEDTIME EQU     d'100'  ;1.00 seconds
  0000000A            00116 LEDErrorTime    EQU     d'10'
  000000C8            00117 kWDTime EQU     d'200'  ;2 seconds
                      00118 ;
  00000001            00119 T1CON_Val       EQU     b'00000001'     ;PreScale=1,Fosc/4,Timer ON
                      00120 ;
                      00121 ;
  0000000A            00122 DebounceTime    EQU     d'10'
                      00123 ;
                      00124 ;================================================================================================
                      00125 ;***** VARIABLE DEFINITIONS
                      00126 ; there are 128 bytes of ram, Bank0 0x20..0x7F, Bank1 0xA0..0xBF
                      00127 ; there are 256 bytes of EEPROM starting at 0x00 the EEPROM is not mapped into memory but
                      00128 ;  accessed through the EEADR and EEDATA registers
                      00129 ;================================================================================================
                      00130 ;  Bank0 Ram 020h-06Fh 80 Bytes
                      00131 ;
                      00132         cblock  0x20
                      00133 ;
  00000020            00134         ISR_Temp                ;scratch mem
  00000021            00135         LED_Time        
  00000022            00136         lastc           ;part of tickcount timmer
  00000023            00137         tickcount               ;Timer tick count
                      00138 ;
                      00139 ;
  00000024            00140         EEAddrTemp              ;EEProm address to read or write
  00000025            00141         EEDataTemp              ;Data to be writen to EEProm
                      00142 ;
                      00143 ;
  00000026            00144         Timer1Lo                ;1st 16 bit timer
  00000027            00145         Timer1Hi                ; one second RX timeiout
  00000028            00146         Timer2Lo                ;2nd 16 bit timer
  00000029            00147         Timer2Hi                ;
  0000002A            00148         Timer3Lo                ;3rd 16 bit timer
  0000002B            00149         Timer3Hi                ;GP wait timer
  0000002C            00150         Timer4Lo                ;4th 16 bit timer
  0000002D            00151         Timer4Hi                ; debounce timer
                      00152 ;
MPASM 5.64  /PROJECTS/I2CTEST/TESTI2CSLAVE.A   11-9-2015  15:32:32         PAGE  4

F1822 Macros
LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  0000002E            00153         SysFlags
                      00154 ;
                      00155         endc
                      00156 ;
                      00157         if useI2CWDT
  00000026            00158 TimerI2C        EQU     Timer1Lo
                      00159         endif
                      00160 ;
  00000030            00161 I2C_ADDRESS     EQU     0x30    ; Slave address
  00000008            00162 TX_ELEMENTS     EQU     .8      ; number of allowable array elements
  00000008            00163 RX_ELEMENTS     EQU     .8      ; number of allowable array elements
  000000AB            00164 I2C_TX_Init_Val EQU     0xAB    ; value to load into transmit array to send to master
  000000AA            00165 I2C_RX_Init_Val EQU     0xAA    ; value to load into received data array
                      00166 ;
                      00167 ;================================================================================================
                      00168 ;  Bank1 Ram 0A0h-0BFh 32 Bytes
                      00169 ;
                      00170 ;
                      00171 I2C_Buffers     udata   0xA0
00A0                  00172 I2C_ARRAY_TX    RES     TX_ELEMENTS     ; array to transmit to master
00A8                  00173 I2C_ARRAY_RX    RES     RX_ELEMENTS     ; array to receive from master
                      00174 ;
                      00175 ;=======================================================================================================
                      00176 ;  Common Ram 70-7F same for all banks
                      00177 ;      except for ISR_W_Temp these are used for paramiter passing and temp vars
                      00178 ;=======================================================================================================
                      00179 ;
                      00180         cblock  0x70
  00000070            00181         Param70
  00000071            00182         Param71
  00000072            00183         Flags
                      00184 ;Globals from I2C_Master.inc
  00000073            00185         TX_DataSize             ; # of bytes to TX, 1..TX_ELEMENTS      
  00000074            00186         INDEX_I2C               ; index used to point to array location
  00000075            00187         GFlags
                      00188 ;
  00000076            00189         Param76
  00000077            00190         Param77
  00000078            00191         Param78
  00000079            00192         Param79
  0000007A            00193         Param7A
  0000007B            00194         Param7B
  0000007C            00195         Param7C
  0000007D            00196         Param7D
  0000007E            00197         Param7E
  0000007F            00198         Param7F
                      00199         endc
                      00200 ;
                      00201 ; Flags bits
                      00202 ;
                      00203 #Define I2C_TXLocked    GFlags,0        ; Set/cleared by ISR, data is being sent
                      00204 #Define I2C_RXLocked    GFlags,1        ; Set/cleared by ISR, data is being received
                      00205 #Define I2C_NewRXData   GFlags,2        ; Set by ISR, The new data is here!
MPASM 5.64  /PROJECTS/I2CTEST/TESTI2CSLAVE.A   11-9-2015  15:32:32         PAGE  5

F1822 Macros
LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00206 ;
                      00207 ;=========================================================================================
                      00208 ;Conditionals
  00000080            00209 HasISR  EQU     0x80    ;used to enable interupts 0x80=true 0x00=false
                      00210 ;
                      00211 ;=========================================================================================
                      00212 ;==============================================================================================
                      00213 ; ID Locations
8000   0001 0000 000D 00214         __idlocs        0x10d2
       0002 
                      00215 ;
                      00216 ;==============================================================================================
                      00217 ;============================================================================================
                      00218 ;
                      00219 ;
                      00220         ORG     0x000   ; processor reset vector
0000   0183           00221         CLRF    STATUS
0001   018A           00222         CLRF    PCLATH
0002   2???           00223         goto    start   ; go to beginning of program
                      00224 ;
                      00225 ;===============================================================================================
                      00226 ; Interupt Service Routine
                      00227 ;
                      00228 ; we loop through the interupt service routing every 0.008192 seconds
                      00229 ;
                      00230 ;
                      00231         ORG     0x004   ; interrupt vector location
0004   0188           00232         CLRF    BSR     ; bank0
                      00233 ;
                      00234 ;
0005   1D0B           00235         btfss   INTCON,T0IF
0006   2???           00236         goto    IRQ_2
                      00237 ;
0007   30B2           00238         movlw   TMR0Val ;256x39+16 cycles (10,000uS)
0008   0795           00239         addwf   TMR0,F  ; reload TMR0 with -40
0009   110B           00240         bcf     INTCON,T0IF     ; reset interupt flag bit
                      00241 ;
                      00242 ;Decrement timers until they are zero
                      00243 ; 
000A   2???           00244         call    DecTimer1       ;if timer 1 is not zero decrement
000B   2???           00245         call    DecTimer2
000C   2???           00246         call    DecTimer3
000D   2???           00247         call    DecTimer4
                      00248 ;
                      00249 ;-----------------------------------------------------------------
                      00250 ; blink LEDs
000E   0021           00251         BankSel TRISA
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
000F   160C           00252         BSF     SysLEDTrisBit   ;LED off
                      00253 ;
                      00254 ;
0010   0020           00255         movlb   0
0011   08A3           00256         MOVF    tickcount,F
MPASM 5.64  /PROJECTS/I2CTEST/TESTI2CSLAVE.A   11-9-2015  15:32:32         PAGE  6

F1822 Macros
LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0012   1903           00257         SKPNZ
0013   2???           00258         GOTO    SystemBlinkDone
0014   03A3           00259         DECF    tickcount,F
0015   1903           00260         SKPNZ
0016   2???           00261         CALL    ToggleSysLED
0017   2???           00262         GOTO    SystemBlink_end
                      00263 ;
0018   08A1           00264 SystemBlinkDone MOVF    LED_Time,F
0019   1D03           00265         SKPZ
001A   2???           00266         CAll    ToggleSysLED
                      00267 ;
001B                  00268 SystemBlink_end 
                      00269 ;
                      00270 ;-----------------------------------------------------------------
                      00271 ;
001B                  00272 IRQ_2:
                      00273 ;==================================================================================
                      00274         if useI2CISR
                      00275 ;-----------------------------------------------------------------------------------------
                      00276 ; I2C Com
001B   0020           00277         MOVLB   0x00
001C   1991           00278         btfsc   PIR1,SSP1IF     ; Is this a SSP interrupt?
001D   2???           00279         call    I2C_ISR
                      00280 ;
                      00281 ;-----------------------------------------------------------------------------------------
                      00282 ; I2C Bus Collision
001E   0020           00283 IRQ_5   MOVLB   0x00
001F   1D92           00284         btfss   PIR2,BCL1IF
0020   2???           00285         goto    IRQ_5_End
                      00286 ;
0021   0024           00287         banksel SSP1BUF                                         
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0022   0811           00288         movf    SSP1BUF,w       ; clear the SSP buffer
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0023   1615           00289         bsf     SSP1CON1,CKP    ; release clock stretch
0024   0020           00290         movlb   0x00
0025   1192           00291         bcf     PIR2,BCL1IF     ; clear the SSP interrupt flag  
                      00292 
0026                  00293 IRQ_5_End:
                      00294 ;
                      00295         endif
                      00296 ;--------------------------------------------------------------------
                      00297 ;
0026   0009           00298         retfie          ; return from interrupt
                      00299 ;
                      00300 ;
                      00301 ;==============================================================================================
                      00302 ;==============================================================================================
                      00303 ; This routine runs every 1/2 second. Unless an error is active then every 1/10th
                      00304 ;
0027   0821           00305 ToggleSysLED    MOVF    LED_Time,W
0028   00A3           00306         MOVWF   tickcount
0029   0021           00307         BankSel TRISA
MPASM 5.64  /PROJECTS/I2CTEST/TESTI2CSLAVE.A   11-9-2015  15:32:32         PAGE  7

F1822 Macros
LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
002A   120C           00308         BCF     SysLEDTrisBit   ;LED on
002B   0020           00309         MOVLB   0
002C   0008           00310         RETURN
                      00311 ;
                      00312 ;==============================================================================================
                      00313 ;==============================================================================================
                      00314 ;
                      00315         include I2C_SLAVE.inc
                      00001 ;=========================================================================================
                      00002 ; PIC16F1822
                      00003 ; I2C SLAVE DRIVER CODE
                      00004 ;
                      00005 ;    Filename:      I2C SLAVE.inc
                      00006 ;    Date:          11/5/2015
                      00007 ;    File Version:  1.0.4
                      00008 ;
                      00009 ;    Author:        David M. Flynn
                      00010 ;    Company:       Oxford V.U.E., Inc.
                      00011 ;    E-Mail:        dflynn@oxfordvue.com
                      00012 ;    Web Site:      http://www.oxfordvue.com/
                      00013 ;
                      00014 ;=========================================================================================
                      00015 ;   I2C Slave Driver Code for PIC16F1822
                      00016 ;
                      00017 ;    History:
                      00018 ;
                      00019 ; 1.0.4 11/5/2015       Optimized some code. Added AHEN=DHEN=1 clock stretching.
                      00020 ; 1.0.3 11/4/2015       Added ACK to R_Data for partial buffer read support.
                      00021 ;       Added PCIE (Stop causes interrupt) to end write 
                      00022 ;        before all RX_ELEMENTS received.
                      00023 ; 1.0.2 4/25/2015       First woring version
                      00024 ; 1.0.1  9/4/2014       Modified for 12F1822
                      00025 ; 1.0   11/23/2013      Adapted from AN734C
                      00026 ;
                      00027 ; *** Adapted from AN734C ****
                      00028 ; PIC16F1937 
                      00029 ;I2C SLAVE DRIVER CODE 
                      00030 ;Author: Chris Best 
                      00031 ;Microchip Technologies
                      00032 ;DATE: 07/03/2013
                      00033 ;
                      00034 ;=========================================================================================
                      00035 ; Options
                      00036 ;
                      00037 ;   I2C_ADDRESS and RX_ELEMENTS must be set and be the same in the master driver.
                      00038 ;
                      00039         ifndef useI2CISR
                      00040         constant        useI2CISR=1
                      00041         endif
                      00042 ;=========================================================================================
                      00043 ;=========================================================================================
                      00044 ; What happens next:
MPASM 5.64  /PROJECTS/I2CTEST/TESTI2CSLAVE.A   11-9-2015  15:32:32         PAGE  8

F1822 Macros
LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00045 ;  Sends or receives RX_ELEMENTS bytes of data from the master
                      00046 ;
                      00047 ;=========================================================================================
                      00048 ; Routines:
                      00049 ;
                      00050 ; Init_I2C      initial setup, call once before starting main event loop
                      00051 ; I2C_READ
                      00052 ; I2C_WRITE
                      00053 ;
                      00054 ;=========================================================================================
                      00055 ;
                      00056 ;
                      00057 ;Note: only upper 7 bits of address are used
                      00058 ;I2C_ADDRESS    EQU     0x30    ; Slave address
                      00059 ;TX_ELEMENTS    EQU     .8      ; number of allowable array elements
                      00060 ;RX_ELEMENTS    EQU     .8      ; number of allowable array elements
                      00061 ;I2C_TX_Init_Val        EQU     0xAA    ; value to load into transmit array to send to master
                      00062 ;I2C_RX_Init_Val        EQU     0xAA    ; value to load into received data array
                      00063 ;
                      00064 ;------------------------------------ variables-------------------------------------------
                      00065 ;
                      00066 ;       cblock  0x70                                                                    ; set up in shar
                            ed memory for easy access
                      00067 ;       INDEX_I2C               ; index used to point to array location
                      00068 ;       TX_DataSize             ; # of bytes to TX, 1..TX_ELEMENTS      
                      00069 ;       GFlags
                      00070 ;       endc
                      00071 ;
                      00072 ;#Define        I2C_TXLocked    GFlags,0        ; Set/cleared by ISR, data is being sent
                      00073 ;#Define        I2C_RXLocked    GFlags,1        ; Set/cleared by ISR, data is being received
                      00074 ;#Define        I2C_NewRXData   GFlags,2        ; Set by ISR, The new data is here!
                      00075 ;
                      00076 ;I2C_Buffers    udata   0xA0
                      00077 ;I2C_ARRAY_TX   RES     TX_ELEMENTS     ; array to transmit to master
                      00078 ;I2C_ARRAY_RX   RES     RX_ELEMENTS     ; array to receive from master
                      00079 ;       
                      00080 ;       if useI2CWDT
                      00081 ;TimerI2C       EQU     Timer1Lo
                      00082 ;       endif
                      00083 ;
                      00084 ;=========================================================================================
                      00085 ;----------------------------------- interrupt service routines --------------------------
                      00086 ;
                      00087 ;-----------------------------------------------------------------------------------------
                      00088 ; I2C Com
                      00089 ;       MOVLB   0x00
                      00090 ;       btfsc   PIR1,SSP1IF     ; Is this a SSP interrupt?
                      00091 ;       call    I2C_ISR
                      00092 ;       movlb   0
                      00093 ;
                      00094 ;-----------------------------------------------------------------------------------------
                      00095 ; I2C Bus Collision
                      00096 ;IRQ_5  MOVLB   0x00
MPASM 5.64  /PROJECTS/I2CTEST/TESTI2CSLAVE.A   11-9-2015  15:32:32         PAGE  9

F1822 Macros
LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00097 ;       btfss   PIR2,BCL1IF
                      00098 ;       goto    IRQ_5_End
                      00099 ;
                      00100 ;       banksel SSP1BUF                                         
                      00101 ;       movf    SSP1BUF,w       ; clear the SSP buffer
                      00102 ;       bsf     SSP1CON1,CKP    ; release clock stretch
                      00103 ;       movlb   0x00
                      00104 ;       bcf     PIR2,BCL1IF     ; clear the SSP interrupt flag  
                      00105 ;
                      00106 ;IRQ_5_End:
                      00107 ;
                      00108 ;=========================================================================================
                      00109 ;
                      00110 ;LOADFSR1       macro   ADDRESS,INDEX   ; ADDRESS = I2C_ARRAY, INDEX = INDEX_I2C                        
                      00111 ;       movlw   low ADDRESS     ; load address                                          
                      00112 ;       addwf   INDEX,W ; add the index value to determine location in array
                      00113 ;       movwf   FSR1L   ; load FSR1L with pointer info
                      00114 ;       clrf    FSR1H
                      00115 ;       movlw   high ADDRESS
                      00116 ;       addwfc  FSR1H,F
                      00117 ;       endm            
                      00118 ;
                      00119 ;=========================================================================================
                      00120 ;       Main
                      00121 ;-----------------------------------------------------------------------------------------
                      00122 ;
                      00123 ;       call    Init_I2C        ; set up uC
                      00124 ;
                      00125 ;=========================================================================================
                      00126 ;=========================================================================================
                      00127 ; I2C Idle routine, only needed if useI2CWDT is used
                      00128 ;=========================================================================================
                      00129 ; Call from main loop
                      00130 ;
002D   0020           00131 I2C_Idle        movlb   0
002E   08A6           00132         movf    TimerI2C,F
002F   1D03           00133         SKPZ
0030   0008           00134         return
                      00135 ;
                      00136 ; fall thru to Init_I2C
                      00137 ;
                      00138 ;-----------------------------------------------------------------------------------------
                      00139 ;       Initialize: Sets up register values 
                      00140 ;-----------------------------------------------------------------------------------------
                      00141 ; fill the RX and TX arrays with I2C_TX_Init_Val, I2C_RX_Init_Val
                      00142 ;
0031                  00143 Init_I2C:
                      00144 ; for J=0 to RX_ELEMENTS-1
                      00145 ;  I2C_ARRAY_TX(J)=I2C_TX_Init_Val
0031   30??           00146         movlw   low I2C_ARRAY_TX
0032   0086           00147         movwf   FSR1L
0033   30??           00148         movlw   high I2C_ARRAY_TX
0034   0087           00149         movwf   FSR1H
MPASM 5.64  /PROJECTS/I2CTEST/TESTI2CSLAVE.A   11-9-2015  15:32:32         PAGE 10

F1822 Macros
LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0035   3008           00150         movlw   TX_ELEMENTS
0036   00F4           00151         movwf   INDEX_I2C
0037   00F3           00152         movwf   TX_DataSize
0038   30AB           00153         movlw   I2C_TX_Init_Val
0039   001E           00154 Init_I2C_L1     movwi   FSR1++
003A   0BF4           00155         decfsz  INDEX_I2C,F
003B   2???           00156         goto    Init_I2C_L1
                      00157 ;
003C   30??           00158         movlw   low I2C_ARRAY_RX
003D   0086           00159         movwf   FSR1L
003E   30??           00160         movlw   high I2C_ARRAY_RX
003F   0087           00161         movwf   FSR1H
0040   3008           00162         movlw   RX_ELEMENTS
0041   00F4           00163         movwf   INDEX_I2C
0042   30AA           00164         movlw   I2C_RX_Init_Val
0043   001E           00165 Init_I2C_L2     movwi   FSR1++
0044   0BF4           00166         decfsz  INDEX_I2C,F
0045   2???           00167         goto    Init_I2C_L2
                      00168 ;
                      00169 ;I2C set up
0046   01F4           00170         clrf    INDEX_I2C       ; index used to point to array location
0047   01F5           00171         clrf    GFlags
                      00172 ;
0048   0024           00173         banksel SSP1STAT
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0049   1794           00174         bsf     SSP1STAT,SMP    ; Slew rate control disabled for standard speed mode
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
004A   0195           00175         clrf    SSP1CON1        ;Reset SSP
004B   3036           00176         movlw   b'00110110'     ; Enable serial port, I2C slave mode, 7-bit address
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
004C   0095           00177         movwf   SSP1CON1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
004D   1416           00178         bsf     SSP1CON2,SEN    ; enable clock stretching
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
004E   1617           00179         bsf     SSP1CON3,BOEN   ; SSPBUF is updated and NACK is generated       
                      00180                         ; for a received address/data byte, 
                      00181                         ; ignoring the state of SSPOV bit only if BF bit = 0.
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
004F   1597           00182         bsf     SSP1CON3,SDAHT  ; Minimum of 300 ns hold time
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0050   1717           00183         bsf     SSP1CON3,PCIE   ; Stop causes interupt
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0051   1497           00184         bsf     SSP1CON3,AHEN   ; Enable address holding, CKP must be set after each byte
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0052   1417           00185         bsf     SSP1CON3,DHEN   ; Enable data holding
0053   3030           00186         movlw   I2C_ADDRESS     ; load the slave address
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0054   0092           00187         movwf   SSP1ADD
                      00188 ;
                      00189         if useI2CISR
0055   0021           00190         movlb   0x01
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0056   1592           00191         bsf     PIE2,BCL1IE     ; enable SSP interrupts
MPASM 5.64  /PROJECTS/I2CTEST/TESTI2CSLAVE.A   11-9-2015  15:32:32         PAGE 11

F1822 Macros
LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0057   1591           00192         bsf     PIE1,SSP1IE     ; enable SSP interrupts
                      00193         endif
0058   0020           00194         movlb   0x00
0059   1191           00195         bcf     PIR1,SSP1IF     ; clear the SSP interrupt flag  
005A   1192           00196         bcf     PIR2,BCL1IF     ; clear the SSP interrupt flag
005B   0008           00197         return
                      00198 ;
                      00199 ;=========================================================================================              
                                            
                      00200 ; Interrupt Service Routines (ISR)
                      00201 ;=========================================================================================
                      00202 ;
005C                  00203 I2C_ISR:
                      00204         if useI2CWDT
005C   17A6           00205         BSF     TimerI2C,7      ;Kick the dog
                      00206         endif
                      00207 ;
005D   1191           00208         bcf     PIR1,SSP1IF     ; clear the SSP interrupt flag
005E   0024           00209         banksel SSP1STAT                                                
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
005F   1D14           00210         btfss   SSP1STAT,R_NOT_W        ; is it a master read:
0060   2???           00211         goto    I2C_WRITE
                      00212 ; I2C_READ
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0061   1A94           00213         btfsc   SSP1STAT,D_NOT_A        ; was last byte an address or data?
0062   2???           00214         goto    R_DATA  ; if set, it was data
                      00215 ;       
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0063   1296           00216 R_ADDRESS       bcf     SSP1CON2,ACKDT
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0064   1F97           00217         btfss   SSP1CON3,ACKTIM
0065   2???           00218         goto    R_Add_ACK
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0066   0811           00219         movf    SSP1BUF,W       ; dummy read to clear BF bit
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0067   1615           00220         bsf     SSP1CON1,CKP    ; release clock stretch
0068   0008           00221         return  
                      00222 ;
0069   01F4           00223 R_Add_ACK       clrf    INDEX_I2C       ; clear index pointer
                      00224         LOADFSR1        I2C_ARRAY_TX,INDEX_I2C
006A   30??               M         movlw   low I2C_ARRAY_TX ; load address                                          
006B   0774               M         addwf   INDEX_I2C,W ; add the index value to determine location in array
006C   0086               M         movwf   FSR1L   ; load FSR1L with pointer info
006D   0187               M         clrf    FSR1H
006E   30??               M         movlw   high I2C_ARRAY_TX
006F   3D87               M         addwfc  FSR1H,F
0070   0801           00225         movf    INDF1,W ; move value into W to load to SSP buffer
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0071   0091           00226         movwf   SSP1BUF ; load SSP buffer
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0072   1615           00227         bsf     SSP1CON1,CKP
                      00228 ;
MPASM 5.64  /PROJECTS/I2CTEST/TESTI2CSLAVE.A   11-9-2015  15:32:32         PAGE 12

F1822 Macros
LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0073   0AF4           00229         incf    INDEX_I2C,F     ; increment INDEX_I2C 'pointer'
0074   1475           00230         bsf     I2C_TXLocked    ; lock data
0075   0008           00231         return
                      00232 ;
                      00233 ;----------------
                      00234 ;
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0076   1B16           00235 R_DATA  btfsc   SSP1CON2,ACKSTAT        ; ACK* = Master wants another byte
0077   2???           00236         goto    R_Data_NACK     ;  don't send another
                      00237 ;
0078   0873           00238         movf    TX_DataSize,W   ; load array elements to TX
0079   0274           00239         subwf   INDEX_I2C,W     ; if Z = 1, subtract index from number of elements
007A   0103           00240         CLRW            ;default to sending 0, filler byte
007B   1803           00241         btfsc   _C      ; did a carry occur after subtraction?
007C   2???           00242         goto    R_PastEnd       ; if so, Master is trying to read to many bytes
                      00243         LOADFSR1        I2C_ARRAY_TX,INDEX_I2C
007D   30??               M         movlw   low I2C_ARRAY_TX ; load address                                          
007E   0774               M         addwf   INDEX_I2C,W ; add the index value to determine location in array
007F   0086               M         movwf   FSR1L   ; load FSR1L with pointer info
0080   0187               M         clrf    FSR1H
0081   30??               M         movlw   high I2C_ARRAY_TX
0082   3D87               M         addwfc  FSR1H,F
0083   0AF4           00244         incf    INDEX_I2C,F     ; increment INDEX_I2C 'pointer'
0084   0801           00245         movf    INDF1,W ; move value into W to load to SSP buffer
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0085   0091           00246 R_PastEnd       movwf   SSP1BUF ; load SSP buffer
                      00247 ;
0086   0873           00248         movf    TX_DataSize,W
0087   0274           00249         subwf   INDEX_I2C,W
0088   1903           00250         btfsc   _Z
0089   1075           00251         BCF     I2C_TXLocked
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
008A   1615           00252         bsf     SSP1CON1,CKP
008B   0008           00253         return
                      00254 ;
008C   1075           00255 R_Data_NACK     BCF     I2C_TXLocked    ;unlock data
008D   0008           00256         Return 
                      00257 ;
                      00258 ;-----------------------------------------------------------------------------------------
                      00259 ;
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
008E   1A94           00260 I2C_WRITE       btfsc   SSP1STAT,D_NOT_A        ; was last byte an address or data?
008F   2???           00261         goto    W_DATA  ; if set, it was data
                      00262 ;
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0090   1296           00263 W_ADDRESS       bcf     SSP1CON2,ACKDT  ;We will ACK*
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0091   0811           00264         movf    SSP1BUF,W       ; dummy read to clear the BF bit
0092   01F4           00265         clrf    INDEX_I2C       ; clear index pointer
0093   14F5           00266         BSF     I2C_RXLocked    ; lock data
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0094   1615           00267 W_ACK   bsf     SSP1CON1,CKP    ; release clock stretch
0095   0008           00268         return
MPASM 5.64  /PROJECTS/I2CTEST/TESTI2CSLAVE.A   11-9-2015  15:32:32         PAGE 13

F1822 Macros
LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00269 ;
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0096   1A14           00270 W_DATA  btfsc   SSP1STAT,P      ;Stop bit?
0097   2???           00271         goto    W_Data_Stop     ;  Yes
                      00272 ;
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0098   1F97           00273         btfss   SSP1CON3,ACKTIM ;Data arrived?
0099   2???           00274         goto    W_ACK   ; no, just an outgoing ACK*     
                      00275 ;       
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
009A   1C14           00276         btfss   SSP1STAT,BF     ;Buffer full?
009B   0008           00277         return          ; no
                      00278 ;
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
009C   1615           00279         bsf     SSP1CON1,CKP    ; release clock stretch
009D   3008           00280         movlw   RX_ELEMENTS     ; load array elements value
009E   0274           00281         subwf   INDEX_I2C,W     ; if Z = 1, subtract index from number of elements
009F   1803           00282         btfsc   _C      ; did a carry occur after subtraction?
00A0   2???           00283         goto    NO_MEM_OVERWRITE        ; if so, Master is trying to write to many bytes
                      00284 ;
                      00285         LOADFSR1        I2C_ARRAY_RX,INDEX_I2C
00A1   30??               M         movlw   low I2C_ARRAY_RX ; load address                                          
00A2   0774               M         addwf   INDEX_I2C,W ; add the index value to determine location in array
00A3   0086               M         movwf   FSR1L   ; load FSR1L with pointer info
00A4   0187               M         clrf    FSR1H
00A5   30??               M         movlw   high I2C_ARRAY_RX
00A6   3D87               M         addwfc  FSR1H,F
00A7   0AF4           00286         incf    INDEX_I2C,F     ; increment INDEX_I2C 'pointer'
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00A8   0811           00287         movf    SSP1BUF,W       ; move the contents of the buffer into W
00A9   0081           00288         movwf   INDF1   ; load INDF1 with data to write
00AA   1575           00289         BSF     I2C_NewRXData   ;new data is available
                      00290 ;
00AB   3008           00291         movlw   RX_ELEMENTS
00AC   0274           00292         subwf   INDEX_I2C,W
00AD   1D03           00293         SKPZ            ;Last byte?
00AE   0008           00294         return          ; no
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00AF   1696           00295         bsf     SSP1CON2,ACKDT  ;Yes, We will not ACK*
                      00296 ;       
00B0   10F5           00297 W_Data_Stop     BCF     I2C_RXLocked    ;unlock data
00B1   0008           00298         return  
                      00299 ;
                      00300 ;-----------------------------------------------------------------------------------------
                      00301 ;
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00B2   0811           00302 NO_MEM_OVERWRITE        movf    SSP1BUF,W       ; clear buffer so no overwrite occurs
00B3   0008           00303         return
                      00304 ;
                      00305 ;-----------------------------------------------------------------------------------------
                      00306 ;
                      00307 ;
                      00308 ;       
MPASM 5.64  /PROJECTS/I2CTEST/TESTI2CSLAVE.A   11-9-2015  15:32:32         PAGE 14

F1822 Macros
LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00309                 
                      00310                 
                      00311                 
                      00312                 
                      00313                 
                      00314                 
                      00315                 
                      00316                 
                      00317                 
                      00318                 
                      00319                 
                      00320                 
                      00321                 
                      00322                                                                                         ; END OF PROGRAM
                      00316 ;
                      00317 ;==============================================================================================
                      00318 ;**********************************************************************************************
                      00319 ;==============================================================================================
                      00320 ;
00B4   0021           00321 start   MOVLB   0x01    ; select bank 1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00B5   1795           00322         bsf     OPTION_REG,NOT_WPUEN    ; disable pullups on port B
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00B6   1295           00323         bcf     OPTION_REG,TMR0CS       ; TMR0 clock Fosc/4
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00B7   1195           00324         bcf     OPTION_REG,PSA  ; prescaler assigned to TMR0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00B8   1415           00325         bsf     OPTION_REG,PS0  ;111 8mhz/4/256=7812.5hz=128uS/Ct=0.032768S/ISR
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00B9   1495           00326         bsf     OPTION_REG,PS1  ;101 8mhz/4/64=31250hz=32uS/Ct=0.008192S/ISR
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00BA   1515           00327         bsf     OPTION_REG,PS2
                      00328 ;
00BB   0021           00329         MOVLB   0x01    ; bank 1
00BC   3070           00330         MOVLW   b'01110000'     ;8MHz
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00BD   0099           00331         MOVWF   OSCCON
00BE   3017           00332         movlw   b'00010111'     ; WDT prescaler 1:65536 period is 2 sec (RESET value)
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00BF   0097           00333         movwf   WDTCON  
                      00334 ;       
                      00335 ;
                      00336 ; setup timer 1 for 0.5uS/count
                      00337 ;
00C0   0020           00338         BANKSEL T1CON   ; bank 0
00C1   3001           00339         MOVLW   T1CON_Val
00C2   0098           00340         MOVWF   T1CON
00C3   1399           00341         bcf     T1GCON,TMR1GE
                      00342 ;
                      00343 ; clear memory to zero
00C4   2???           00344         CALL    ClearRam
                      00345 ;
                      00346 ;
MPASM 5.64  /PROJECTS/I2CTEST/TESTI2CSLAVE.A   11-9-2015  15:32:32         PAGE 15

F1822 Macros
LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00347 ; setup data ports
00C5   0020           00348         BANKSEL PORTA
00C6   3000           00349         MOVLW   PortAValue
00C7   008C           00350         MOVWF   PORTA   ;Init PORTA
00C8   0023           00351         BANKSEL ANSELA
00C9   3000           00352         MOVLW   0x00
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00CA   008C           00353         MOVWF   ANSELA  ;digital I/O
00CB   0021           00354         BANKSEL TRISA
00CC   30CF           00355         MOVLW   PortADDRBits
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00CD   008C           00356         MOVWF   TRISA
                      00357 ;
00CE   0020           00358         MOVLB   0       ;bank 0
00CF   0064           00359         CLRWDT
                      00360 ;
00D0   3064           00361         MOVLW   LEDTIME
00D1   00A1           00362         MOVWF   LED_Time
                      00363 ;
00D2   3001           00364         MOVLW   0x01
00D3   00A3           00365         MOVWF   tickcount
                      00366 ;
00D4   0064           00367         CLRWDT
                      00368 ;
                      00369 ;
00D5   170B           00370         bsf     INTCON,PEIE     ; enable periferal interupts
00D6   168B           00371         bsf     INTCON,T0IE     ; enable TMR0 interupt
00D7   178B           00372         bsf     INTCON,GIE      ; enable interupts
                      00373 ;
00D8   0020           00374         MOVLB   0x00    ;bank 0
00D9   2???           00375         call    Init_I2C        ;setup I2C
                      00376 ;
                      00377 ;=========================================================================================
                      00378 ;=========================================================================================
                      00379 ;  Main Loop
                      00380 ;
00DA   0064           00381 MainLoop        CLRWDT
00DB   2???           00382         CALL    I2C_DataInturp
                      00383 ;
00DC   2???           00384         CALL    I2C_DataSender
                      00385 ;
                      00386         if useI2CWDT
00DD   2???           00387         CALL    I2C_Idle
                      00388         endif
                      00389 ;
                      00390         if useI2CISR==0
                      00391         MOVLB   0x00
                      00392         btfsc   PIR1,SSP1IF     ; Is this a SSP interrupt?
                      00393         call    I2C_ISR
                      00394 ;
                      00395 ;-----------------------------------------------------------------------------------------
                      00396 ; I2C Bus Collision
                      00397 IRQ_5   MOVLB   0x00
MPASM 5.64  /PROJECTS/I2CTEST/TESTI2CSLAVE.A   11-9-2015  15:32:32         PAGE 16

F1822 Macros
LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00398         btfss   PIR2,BCL1IF
                      00399         goto    IRQ_5_End
                      00400 ;
                      00401         banksel SSP1BUF                                         
                      00402         movf    SSP1BUF,w       ; clear the SSP buffer
                      00403         bsf     SSP1CON1,CKP    ; release clock stretch
                      00404         movlb   0x00
                      00405         bcf     PIR2,BCL1IF     ; clear the SSP interrupt flag
                      00406 IRQ_5_End:      
                      00407         endif
                      00408 ;
00DE   2???           00409         goto    MainLoop
                      00410 ;
                      00411 ;==============================================================
                      00412 ;
00DF                  00413 I2C_DataInturp:
00DF   18F5           00414         BTFSC   I2C_RXLocked
00E0   0008           00415         RETURN
00E1   1D75           00416         BTFSS   I2C_NewRXData   ;Data is new?
00E2   0008           00417         RETURN          ; No
00E3   1175           00418         BCF     I2C_NewRXData
00E4   3003           00419         MOVLW   0x03
00E5   00F9           00420         MOVWF   Param79 ;offset
                      00421         LOADFSR0        I2C_ARRAY_RX,Param79
00E6   30??               M         movlw   low I2C_ARRAY_RX ; load address                                          
00E7   0779               M         addwf   Param79,W ; add the index value to determine location in array
00E8   0084               M         movwf   FSR0L   ; load FSR0L with pointer info
00E9   0185               M         clrf    FSR0H
00EA   30??               M         movlw   high I2C_ARRAY_RX
00EB   3D85               M         addwfc  FSR0H,F
00EC   0800           00422         MOVF    INDF0,W
00ED   00F8           00423         MOVWF   Param78
                      00424 ;
00EE   0022           00425         MOVLB   0x02
00EF   1C78           00426         BTFSS   Param78,0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00F0   128C           00427         BCF     LED1Bit
00F1   1878           00428         BTFSC   Param78,0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00F2   168C           00429         BSF     LED1Bit
00F3   0020           00430         MOVLB   0x00
00F4   0008           00431         RETURN
                      00432 ;
                      00433 ;==============================================================
                      00434 ;
00F5   1875           00435 I2C_DataSender  BTFSC   I2C_TXLocked
00F6   0008           00436         RETURN
                      00437 ;
00F7   01F8           00438         CLRF    Param78
00F8   1D8C           00439         BTFSS   SW1BtnBit
00F9   1478           00440         BSF     Param78,0
                      00441 ;
00FA   3003           00442         MOVLW   0x03
MPASM 5.64  /PROJECTS/I2CTEST/TESTI2CSLAVE.A   11-9-2015  15:32:32         PAGE 17

F1822 Macros
LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00FB   00F9           00443         MOVWF   Param79 ;offset
                      00444         LOADFSR0        I2C_ARRAY_TX,Param79
00FC   30??               M         movlw   low I2C_ARRAY_TX ; load address                                          
00FD   0779               M         addwf   Param79,W ; add the index value to determine location in array
00FE   0084               M         movwf   FSR0L   ; load FSR0L with pointer info
00FF   0185               M         clrf    FSR0H
0100   30??               M         movlw   high I2C_ARRAY_TX
0101   3D85               M         addwfc  FSR0H,F
0102   0878           00445         MOVF    Param78,W
0103   0080           00446         MOVWF   INDF0
                      00447 ;
0104   0008           00448         RETURN
                      00449 ;=========================================================================================
                      00450 ;=========================================================================================
                      00451 ;
                      00452         include F1822_Common.inc
                      00001 ;=========================================================================================
                      00002 ; Commonly used routines PIC16F1822 version
                      00003 ;
                      00004 ;    Filename:      F1822 Common.inc
                      00005 ;    Date:          9/4/2014
                      00006 ;    File Version:  1.0.1
                      00007 ;
                      00008 ;    Author:        David M. Flynn
                      00009 ;    Company:       Oxford V.U.E., Inc.
                      00010 ;    E-Mail:        dflynn@oxfordvue.com
                      00011 ;    Web Site:      http://www.oxfordvue.com/
                      00012 ;
                      00013 ;=========================================================================================
                      00014 ;    History:
                      00015 ;
                      00016 ; 1.0.1 9/4/2014        Updated from F1847 Common.inc
                      00017 ; 1.0   11/16/2013      Updated from F648A Common.inc
                      00018 ;
                      00019 ;=========================================================================================
                      00020 ; Routines:
                      00021 ;
                      00022 ; ClearRam      (2+0) Clears all RAM, call once before initializing variables, FSR0
                      00023 ; CopyToRam     (1+0) copy param memory (EEPROM) to ram, call once, FSR0
                      00024 ; SaveParams    (1+0) copy ram to param memory (EEPROM), FSR0
                      00025 ; TX_TheByte    (0+0) Send one byte to UART
                      00026 ; RX_TheByte    (0+0) Receive one byte from UART
                      00027 ;
                      00028 ; DecTimer4     (0+0) Decrement routine for 16 bit timers, FSR0
                      00029 ; DecTimer3
                      00030 ; DecTimer2
                      00031 ; DecTimer1
                      00032 ;
                      00033 ; TestT4_Zero   Test for 16 bit timers = zero
                      00034 ; TestT3_Zero   If Timer is zero return Z flag,1 else Z=0
                      00035 ; TestT2_Zero
                      00036 ; TestT1_Zero
                      00037 ;
MPASM 5.64  /PROJECTS/I2CTEST/TESTI2CSLAVE.A   11-9-2015  15:32:32         PAGE 18

F1822 Macros
LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00038 ; Delay10uS     (0+0)Delay uS    1 cycle = 1uS, 8Mhz clock version
                      00039 ; Delay100uS
                      00040 ; Delay40uS
                      00041 ; DelayWuS
                      00042 ;
                      00043 ; EEReadW       (0+0) Read EEPROM address in W
                      00044 ; EERead        (0+0) Read EEPROM address in EEAddrTemp
                      00045 ; EEWriteW      (0+0) Write EEPROM address in W, Data in EEDataTemp
                      00046 ; EEWrite       (0+0) Write EEPROM address in EEAdrTemp, Data in EEDataTemp, FSR0
                      00047 ;
                      00048 ; StoreSerIn    Put the byte in W into the serial input buffer, FSR0
                      00049 ; GetSerIn      Get a byte from the serial input buffer, FSR0
                      00050 ; GetSerOutBytes        Get the number of bytes in the serial ouput buffer
                      00051 ; StoreSerOut   Put the byte in W into the serial output buffer, FSR0
                      00052 ; POP_SerOut    Remove the last char stored in the output buffer
                      00053 ; GetSerOut     Get a byte from the serial Output buffer, FSR0
                      00054 ;
                      00055 ;=========================================================================================
                      00056 ; Clears all RAM
                      00057 ; Entry: none
                      00058 ; Exit: none
                      00059 ; RAM used: All
                      00060 ; Calls:(2+0) ClearRam_L2
                      00061 ;
0105   0020           00062 ClearRam        MOVLB   0x00
0106   305F           00063         MOVLW   0x5F    ;Clear 20h-7Eh, 95 bytes
0107   00FF           00064         MOVWF   Param7F
0108   3020           00065         MOVLW   0x20
0109   0084           00066         MOVWF   FSR0
010A   0185           00067         CLRF    FSR0H
010B   2???           00068         CALL    ClearRam_L2
                      00069 ;
010C   3020           00070         MOVLW   0x20    ;Clear A0h-BFh, 32 bytes
010D   00FF           00071         MOVWF   Param7F
010E   30A0           00072         MOVLW   0xA0
010F   0084           00073         MOVWF   FSR0
                      00074 ;
0110   0180           00075 ClearRam_L2     CLRF    INDF0
0111   0A84           00076         INCF    FSR0,F
0112   0BFF           00077         DECFSZ  Param7F,F
0113   2???           00078         GOTO    ClearRam_L2
0114   0008           00079         RETURN
                      00080 ;
                      00081         ifndef UesesCopyToRam
                      00082         constant UesesCopyToRam=0
                      00083         endif
                      00084         if UesesCopyToRam
                      00085 ;==========================================================================
                      00086 ; copy param memory to ram
                      00087 ;
                      00088 CopyToRam:
                      00089         BankSel EEAddrTemp
                      00090         MOVLW   nvFirstParamByte
MPASM 5.64  /PROJECTS/I2CTEST/TESTI2CSLAVE.A   11-9-2015  15:32:32         PAGE 19

F1822 Macros
LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00091         MOVWF   EEAddrTemp
                      00092         MOVLW   FirstRAMParam
                      00093         MOVWF   FSR0
                      00094         CLRF    FSR0H
                      00095 CopyToRam_L1    CALL    EERead
                      00096         MOVWF   INDF0
                      00097         MOVLW   LastRAMParam
                      00098         SUBWF   FSR0,W
                      00099         SKPNZ
                      00100         RETURN
                      00101         INCF    FSR0,F
                      00102         INCF    EEAddrTemp,F
                      00103         GOTO    CopyToRam_L1
                      00104 ;
                      00105 ;===========================================================================
                      00106 ; copy ram to param memory
                      00107 ;
                      00108 SaveParams:
                      00109         BankSel EEAddrTemp
                      00110         MOVLW   nvFirstParamByte
                      00111         MOVWF   EEAddrTemp
                      00112         MOVLW   FirstRAMParam
                      00113         MOVWF   FSR0
                      00114         CLRF    FSR0H
                      00115 SaveParams_L1   MOVF    INDF0,W
                      00116         MOVWF   EEDataTemp
                      00117         CALL    EEWrite
                      00118         MOVLW   LastRAMParam    ;last byte
                      00119         SUBWF   FSR0,W
                      00120         SKPNZ
                      00121         RETURN
                      00122         INCF    FSR0,F
                      00123         INCF    EEAddrTemp,F
                      00124         GOTO    SaveParams_L1
                      00125 ;
                      00126         endif
                      00127 ;=====================================================================================================
                      00128 ;=======================================================================================================
                            ==
                      00129 ; Decrement routine for 16 bit timers
                      00130 ;
0115   302D           00131 DecTimer4       movlw   Timer4Hi
0116   2???           00132         goto    DecTimer
0117   302B           00133 DecTimer3       movlw   Timer3Hi
0118   2???           00134         goto    DecTimer
0119   3029           00135 DecTimer2       movlw   Timer2Hi
011A   2???           00136         goto    DecTimer
011B   3027           00137 DecTimer1       movlw   Timer1Hi
                      00138 ;DecTimer
                      00139 ; entry: FSR=Timer(n)Hi
011C   0084           00140 DecTimer        MOVWF   FSR0
011D   0800           00141         MOVF    INDF0,W ;TimerNHi
011E   0384           00142         DECF    FSR0,F
MPASM 5.64  /PROJECTS/I2CTEST/TESTI2CSLAVE.A   11-9-2015  15:32:32         PAGE 20

F1822 Macros
LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

011F   0400           00143         IORWF   INDF0,W ;TimerNLo
0120   1903           00144         SKPNZ
0121   0008           00145         RETURN
0122   3001           00146         MOVLW   0x01
0123   0280           00147         SUBWF   INDF0,F ;TimerNLo
0124   0A84           00148         INCF    FSR0,F
0125   3000           00149         MOVLW   0x00
0126   3B80           00150         SUBWFB  INDF0,F ;TimerNHi
0127   0008           00151         RETURN
                      00152 ;
                      00153 ;==============================================================================================
                      00154 ; Test for 16 bit timers = zero
                      00155 ;If Timer is zero return Z flag,1 else Z=0
                      00156 ;
0128   082C           00157 TestT4_Zero     movf    Timer4Lo,W
0129   042D           00158         iorwf   Timer4Hi,W
012A   0008           00159         return
                      00160 ;
012B   082A           00161 TestT3_Zero     movf    Timer3Lo,W
012C   042B           00162         iorwf   Timer3Hi,W
012D   0008           00163         return
                      00164 ;
012E   0828           00165 TestT2_Zero     movf    Timer2Lo,W
012F   0429           00166         iorwf   Timer2Hi,W
0130   0008           00167         return
                      00168 ;
0131   0826           00169 TestT1_Zero     movf    Timer1Lo,W
0132   0427           00170         iorwf   Timer1Hi,W
0133   0008           00171         return  
                      00172 ;
                      00173 ;======================================================================================
                      00174 ;Delay uS    1 cycle = 1uS, 8Mhz clock version
                      00175 ; RAM used: Param77
                      00176 ; Calls:(0) none
0134   3005           00177 Delay10uS       MOVLW   0x05    ;(2*3+5)/2=10
0135   2???           00178         GOTO    DelayWuS
0136   3041           00179 Delay100uS      MOVLW   d'65'   ;(28*3+5)/2=100
0137   2???           00180         GOTO    DelayWuS
0138   3019           00181 Delay40uS       MOVLW   d'25'   ;(11*3+5)=40
0139   00F7           00182 DelayWuS        MOVWF   Param77
013A   0BF7           00183 DelayWuS_Loop   DECFSZ  Param77,F
013B   2???           00184         GOTO    DelayWuS_Loop
013C   0008           00185         RETURN
                      00186 ;
                      00187 ;==============================================================================================
                      00188 ; Read EEPROM
                      00189 ; entry: EEPROM address to read in W
                      00190 ;        Bank 0 selected
                      00191 ; exit: W=EEDATA, Bank 0 selected
                      00192 ;
013D   00A4           00193 EEReadW movwf   EEAddrTemp
                      00194 ;
                      00195 ;==============================================================================================
MPASM 5.64  /PROJECTS/I2CTEST/TESTI2CSLAVE.A   11-9-2015  15:32:32         PAGE 21

F1822 Macros
LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00196 ; Read EEPROM
                      00197 ; entry: EEPROM address to read in EEAddrTemp
                      00198 ;        Bank 0 selected
                      00199 ; exit: W=EEDATA, Bank 0 selected
                      00200 ;
013E   0824           00201 EERead  MOVF    EEAddrTemp,W    ;Data Memory
013F   0023           00202         BANKSEL EEADRL
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0140   0091           00203         MOVWF   EEADRL  ;Address to read
                      00204 ;
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0141   1315           00205         BCF     EECON1,CFGS     ;Deselect Config space
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0142   1395           00206         BCF     EECON1,EEPGD    ;Point to DATA memory
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0143   1415           00207         BSF     EECON1,RD       ;EE Read
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0144   0813           00208         MOVF    EEDATL,W        ;W = EEDATL
0145   0020           00209         MOVLB   0x00    ;Bank 0
0146   0008           00210         return
                      00211 ;       
                      00212 ;==============================================================================================
                      00213 ; Write EEPROM
                      00214 ; entry: EEPROM address to write in W
                      00215 ;        EEPROM data to write in EEDataTemp
                      00216 ;        Bank 0 selected
                      00217 ; exit: Bank 0 selected
                      00218 ;
0147   00A4           00219 EEWriteW        movwf   EEAddrTemp
                      00220 ;
                      00221 ;==============================================================================================
                      00222 ; Write EEPROM
                      00223 ; entry: EEPROM address to write in EEAdrTemp
                      00224 ;        EEPROM data to write in EEDataTemp
                      00225 ;        Bank 0 selected
                      00226 ; exit: Bank 0 selected
                      00227 ;
0148   0824           00228 EEWrite MOVF    EEAddrTemp,W
0149   0023           00229         BANKSEL EEADRL
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
014A   0091           00230         MOVWF   EEADRL  ;Data Memory Address to write
014B   0020           00231         BankSel EEDataTemp
014C   0825           00232         MOVF    EEDataTemp,W
014D   0023           00233         BANKSEL EEDATL
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
014E   0093           00234         MOVWF   EEDATL  ;Data Memory Value to write
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
014F   1315           00235         BCF     EECON1,CFGS     ;Deselect Configuration space
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0150   1395           00236         BCF     EECON1,EEPGD    ;Point to DATA memory
0151   138B           00237         BCF     INTCON,GIE      ;Disable INTs.
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0152   1515           00238         BSF     EECON1,WREN     ;Enable writes
MPASM 5.64  /PROJECTS/I2CTEST/TESTI2CSLAVE.A   11-9-2015  15:32:32         PAGE 22

F1822 Macros
LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0153   3055           00239         MOVLW   0x55
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0154   0096           00240         MOVWF   EECON2  ;Write 55h
0155   30AA           00241         MOVLW   0xAA
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0156   0096           00242         MOVWF   EECON2  ;Write AAh
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0157   1495           00243         BSF     EECON1,WR       ;Set WR bit to begin write
0158   178B           00244         BSF     INTCON,GIE      ;Enable Interrupts
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0159   1115           00245         BCF     EECON1,WREN     ;Disable writes
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
015A   1895           00246 EEWriteLoop     BTFSC   EECON1,WR       ;Wait for write to complete
015B   2???           00247         GOTO    EEWriteLoop
015C   0020           00248         MOVLB   0x00    ;Bank 0
015D   0008           00249         return
                      00250 ;
                      00251 ;=======================================================================================================
                            ==
                      00252         IF useRS232
                      00253 ;=====================================================================================================
                      00254 ; Send one byte
                      00255 ; Entry: Bank0
                      00256 ; Exit: Bank0
                      00257 ;
                      00258 ;
                      00259 TX_TheByte      MOVF    TXByte,W
                      00260         BTFSS   DataSentFlag
                      00261         MOVWF   TXREG
                      00262         BSF     DataSentFlag
                      00263         RETURN
                      00264 ;
                      00265 ;=====================================================================================================
                      00266 ;
                      00267 RX_TheByte      MOVF    RCSTA,W
                      00268         ANDLW   0x06
                      00269         SKPZ            ;Fame or Overrun Err?
                      00270         GOTO    RX_TheByte_Err  ; yes
                      00271         MOVF    RCREG,W
                      00272 ;
                      00273         MOVWF   RXByte
                      00274         BSF     DataReceivedFlag
                      00275         RETURN
                      00276 ;
                      00277 RX_TheByte_Err  MOVF    RCREG,W ;bad byte so drop it
                      00278         CLRF    RXByte
                      00279         BCF     RCSTA,CREN
                      00280         BCF     RCSTA,FERR
                      00281         BCF     RCSTA,OERR
                      00282         BSF     RCSTA,CREN
                      00283         RETURN
                      00284 ;
                      00285 ;=======================================================================================================
MPASM 5.64  /PROJECTS/I2CTEST/TESTI2CSLAVE.A   11-9-2015  15:32:32         PAGE 23

F1822 Macros
LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                            ==
                      00286 ;=============================================================================================
                      00287 ; Put the byte in W into the serial input buffer
                      00288 ;
                      00289 ; Entry: W = byte to store
                      00290 ; Exit: none
                      00291 ;
                      00292 StoreSerIn      MOVWF   Param78
                      00293         MOVLB   Ser_Buff_Bank
                      00294         INCF    Ser_In_Bytes,F
                      00295 ;       
                      00296         MOVF    Ser_In_InPtr,W
                      00297         ANDLW   0x1F
                      00298         INCF    Ser_In_InPtr,F
                      00299         ADDLW   low Ser_In_Buff
                      00300         MOVWF   FSR0
                      00301         MOVLW   high Ser_In_Buff
                      00302         MOVWF   FSR0H
                      00303         MOVF    Param78,W
                      00304         MOVWF   INDF0
                      00305         MOVLB   0x00
                      00306         RETURN
                      00307 ;
                      00308 ;=============================================================================================
                      00309 ; Get a byte from the serial input buffer
                      00310 ;
                      00311 ; Entry: none
                      00312 ; Exit: W=byte from buffer, Param78,0=valid
                      00313 ;
                      00314 GetSerIn        MOVLB   Ser_Buff_Bank
                      00315         BCF     Param78,0       ;no data
                      00316         MOVF    Ser_In_Bytes,F
                      00317         SKPNZ
                      00318         GOTO    Bank0Rtn
                      00319         BSF     Param78,0
                      00320         DECF    Ser_In_Bytes,F
                      00321         MOVF    Ser_In_OutPtr,W
                      00322         ANDLW   0x1F
                      00323         INCF    Ser_In_OutPtr,F
                      00324         ADDLW   low Ser_In_Buff
                      00325         MOVWF   FSR0
                      00326         MOVLW   high Ser_In_Buff
                      00327         MOVWF   FSR0H
                      00328         MOVF    INDF0,W
                      00329 Bank0Rtn        MOVLB   0x00
                      00330         RETURN
                      00331 ;
                      00332 ;=============================================================================================
                      00333 ; Get the number of bytes in the serial ouput buffer
                      00334 ;
                      00335 ; Entry: none
                      00336 ; Exit: W=bytes in buffer, Z
                      00337 ;
MPASM 5.64  /PROJECTS/I2CTEST/TESTI2CSLAVE.A   11-9-2015  15:32:32         PAGE 24

F1822 Macros
LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00338 GetSerOutBytes  MOVLB   Ser_Buff_Bank
                      00339         MOVF    Ser_Out_Bytes,W
                      00340         MOVLB   0x00
                      00341         RETURN
                      00342 ;
                      00343 ;=============================================================================================
                      00344 ; Put the byte in W into the serial output buffer
                      00345 ;
                      00346 ; Entry: W = byte to store
                      00347 ; Exit: Param78 & W = byte stored
                      00348 ;
                      00349 StoreSerOut     MOVWF   Param78
                      00350         MOVLB   Ser_Buff_Bank
                      00351         INCF    Ser_Out_Bytes,F
                      00352 ;       
                      00353         MOVF    Ser_Out_InPtr,W
                      00354         ANDLW   0x1F
                      00355         INCF    Ser_Out_InPtr,F
                      00356         ADDLW   low Ser_Out_Buff
                      00357         MOVWF   FSR0
                      00358         MOVLW   high Ser_In_Buff
                      00359         MOVWF   FSR0H
                      00360         MOVF    Param78,W
                      00361         MOVWF   INDF0
                      00362         MOVLB   0x00
                      00363         RETURN
                      00364 ;
                      00365 ;=============================================================================================
                      00366 ; Remove the last char stored in the output buffer
                      00367 ;
                      00368 POP_SerOut      MOVLB   Ser_Buff_Bank
                      00369         MOVF    Ser_Out_Bytes,F
                      00370         SKPNZ
                      00371         GOTO    Bank0Rtn
                      00372         DECF    Ser_Out_Bytes,F
                      00373         DECF    Ser_Out_InPtr,F
                      00374         MOVLB   0x00
                      00375         RETURN
                      00376 ;
                      00377 ;=============================================================================================
                      00378 ; Get a byte from the serial Output buffer
                      00379 ;
                      00380 ; Entry: none
                      00381 ; Exit: W=byte from buffer, Param78,0=valid
                      00382 ;
                      00383 GetSerOut       MOVLB   Ser_Buff_Bank
                      00384         BCF     Param78,0       ;no data
                      00385         MOVF    Ser_Out_Bytes,F
                      00386         SKPNZ
                      00387         GOTO    Bank0Rtn
                      00388         BSF     Param78,0
                      00389         DECF    Ser_Out_Bytes,F
                      00390         MOVF    Ser_Out_OutPtr,W
MPASM 5.64  /PROJECTS/I2CTEST/TESTI2CSLAVE.A   11-9-2015  15:32:32         PAGE 25

F1822 Macros
LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00391         ANDLW   0x1F
                      00392         INCF    Ser_Out_OutPtr,F
                      00393         ADDLW   low Ser_Out_Buff
                      00394         MOVWF   FSR0
                      00395         MOVLW   high Ser_In_Buff
                      00396         MOVWF   FSR0H
                      00397         MOVF    INDF0,W
                      00398         MOVLB   0x00
                      00399         RETURN
                      00400 ;
                      00401         ENDIF
                      00402 ;
                      00403 ;
                      00453 ;
                      00454 ;=========================================================================================
                      00455 ;=========================================================================================
                      00456 ;
                      00457 ;
                      00458 ;
                      00459 ;
Message[303]: Program word too large.  Truncated to core size. (EFA4)
Message[303]: Program word too large.  Truncated to core size. (DEFF)
2FA4 1EFF             00460         END
MPASM 5.64  /PROJECTS/I2CTEST/TESTI2CSLAVE.A   11-9-2015  15:32:32         PAGE 26

F1822 Macros
SYMBOL TABLE
  LABEL                             VALUE 

ABDEN                             00000000
ABDOVF                            00000007
ACKDT                             00000005
ACKEN                             00000004
ACKSTAT                           00000006
ACKTIM                            00000007
ADCON0                            0000009D
ADCON1                            0000009E
ADCS0                             00000004
ADCS1                             00000005
ADCS2                             00000006
ADDEN                             00000003
ADFM                              00000007
ADFVR0                            00000000
ADFVR1                            00000001
ADGO                              00000001
ADIE                              00000006
ADIF                              00000006
ADON                              00000000
ADPREF0                           00000000
ADPREF1                           00000001
ADRES                             0000009B
ADRESH                            0000009C
ADRESL                            0000009B
AHEN                              00000001
AN0                               00000000
AN1                               00000001
AN2                               00000002
AN3                               00000004
ANSA0                             00000000
ANSA1                             00000001
ANSA2                             00000002
ANSA4                             00000004
ANSELA                            0000018C
APFCON                            0000011D
APFCON0                           0000011D
All_In                            000000FF
All_Out                           00000000
BAUDCON                           0000019F
BCL1IE                            00000003
BCL1IF                            00000003
BEQ                               
BF                                00000000
BMI                               
BNE                               
BOEN                              00000004
BORCON                            00000116
BORRDY                            00000000
BPL                               
BRG16                             00000003
BRGH                              00000002
BSR                               00000008
BSR0                              00000000
MPASM 5.64  /PROJECTS/I2CTEST/TESTI2CSLAVE.A   11-9-2015  15:32:32         PAGE 27

F1822 Macros
SYMBOL TABLE
  LABEL                             VALUE 

BSR1                              00000001
BSR2                              00000002
BSR3                              00000003
BSR4                              00000004
BSR_SHAD                          00000FE6
C                                 00000000
C1HYS                             00000001
C1IE                              00000005
C1IF                              00000005
C1IN0N                            00000001
C1IN1N                            00000004
C1INP                             00000000
C1INTN                            00000006
C1INTP                            00000007
C1NCH0                            00000000
C1OE                              00000005
C1ON                              00000007
C1OUT_CM1CON0                     00000006
C1OUT_PORTA                       00000002
C1PCH0                            00000004
C1PCH1                            00000005
C1POL                             00000004
C1SP                              00000002
C1SYNC                            00000000
CCP1AS                            00000295
CCP1AS0                           00000004
CCP1AS1                           00000005
CCP1AS2                           00000006
CCP1ASE                           00000007
CCP1CON                           00000293
CCP1IE                            00000002
CCP1IF                            00000002
CCP1M0                            00000000
CCP1M1                            00000001
CCP1M2                            00000002
CCP1M3                            00000003
CCP1SEL                           00000000
CCPR1                             00000291
CCPR1H                            00000292
CCPR1L                            00000291
CDAFVR0                           00000002
CDAFVR1                           00000003
CFGS                              00000006
CHS0                              00000002
CHS1                              00000003
CHS2                              00000004
CHS3                              00000005
CHS4                              00000006
CKE                               00000006
CKP                               00000004
CLKIN                             00000005
CLKOUT                            00000004
CLKR                              00000004
MPASM 5.64  /PROJECTS/I2CTEST/TESTI2CSLAVE.A   11-9-2015  15:32:32         PAGE 28

F1822 Macros
SYMBOL TABLE
  LABEL                             VALUE 

CLKRCON                           0000039A
CLKRDC0                           00000003
CLKRDC1                           00000004
CLKRDIV0                          00000000
CLKRDIV1                          00000001
CLKRDIV2                          00000002
CLKREN                            00000007
CLKROE                            00000006
CLKRSLR                           00000005
CM1CON0                           00000111
CM1CON1                           00000112
CMOUT                             00000115
CMP                               
CPS0                              00000000
CPS1                              00000001
CPS2                              00000002
CPS3                              00000004
CPSCH0                            00000000
CPSCH1                            00000001
CPSCON0                           0000001E
CPSCON1                           0000001F
CPSON                             00000007
CPSOUT                            00000001
CPSRM                             00000006
CPSRNG0                           00000002
CPSRNG1                           00000003
CREN                              00000004
CSRC                              00000007
C_SHAD                            00000000
ClearRam                          00000105
ClearRam_L2                       00000110
DACCON0                           00000118
DACCON1                           00000119
DACEN                             00000007
DACLPS                            00000006
DACOE                             00000005
DACOUT                            00000000
DACPSS0                           00000002
DACPSS1                           00000003
DACR0                             00000000
DACR1                             00000001
DACR2                             00000002
DACR3                             00000003
DACR4                             00000004
DC                                00000001
DC1B0                             00000004
DC1B1                             00000005
DC_SHAD                           00000001
DHEN                              00000000
D_NOT_A                           00000005
DebounceTime                      0000000A
DecTimer                          0000011C
DecTimer1                         0000011B
MPASM 5.64  /PROJECTS/I2CTEST/TESTI2CSLAVE.A   11-9-2015  15:32:32         PAGE 29

F1822 Macros
SYMBOL TABLE
  LABEL                             VALUE 

DecTimer2                         00000119
DecTimer3                         00000117
DecTimer4                         00000115
Delay100uS                        00000136
Delay10uS                         00000134
Delay40uS                         00000138
DelayWuS                          00000139
DelayWuS_Loop                     0000013A
ECCP1AS                           00000295
EEADR                             00000191
EEADRH                            00000192
EEADRL                            00000191
EEAddrTemp                        00000024
EECON1                            00000195
EECON2                            00000196
EEDAT                             00000193
EEDATH                            00000194
EEDATL                            00000193
EEDataTemp                        00000025
EEIE                              00000004
EEIF                              00000004
EEPGD                             00000007
EERead                            0000013E
EEReadW                           0000013D
EEWrite                           00000148
EEWriteLoop                       0000015A
EEWriteW                          00000147
F                                 00000001
FERR                              00000002
FLT0                              00000002
FREE                              00000004
FSR0                              00000004
FSR0H                             00000005
FSR0H_SHAD                        00000FE9
FSR0L                             00000004
FSR0L_SHAD                        00000FE8
FSR1                              00000006
FSR1H                             00000007
FSR1H_SHAD                        00000FEB
FSR1L                             00000006
FSR1L_SHAD                        00000FEA
FVRCON                            00000117
FVREN                             00000007
FVRRDY                            00000006
Flags                             00000072
GCEN                              00000007
GFlags                            00000075
GIE                               00000007
GO                                00000001
GO_NOT_DONE                       00000001
HFIOFL                            00000003
HFIOFR                            00000004
HFIOFS                            00000000
MPASM 5.64  /PROJECTS/I2CTEST/TESTI2CSLAVE.A   11-9-2015  15:32:32         PAGE 30

F1822 Macros
SYMBOL TABLE
  LABEL                             VALUE 

HasISR                            00000080
I2C_ADDRESS                       00000030
I2C_ARRAY_RX                      000000A8
I2C_ARRAY_TX                      000000A0
I2C_DataInturp                    000000DF
I2C_DataSender                    000000F5
I2C_ISR                           0000005C
I2C_Idle                          0000002D
I2C_NewRXData                     GFlags,2
I2C_RXLocked                      GFlags,1
I2C_RX_Init_Val                   000000AA
I2C_TXLocked                      GFlags,0
I2C_TX_Init_Val                   000000AB
I2C_WRITE                         0000008E
INDEX_I2C                         00000074
INDF0                             00000000
INDF1                             00000001
INTCON                            0000000B
INTE                              00000004
INTEDG                            00000006
INTF                              00000001
IOCAF                             00000393
IOCAF0                            00000000
IOCAF1                            00000001
IOCAF2                            00000002
IOCAF3                            00000003
IOCAF4                            00000004
IOCAF5                            00000005
IOCAN                             00000392
IOCAN0                            00000000
IOCAN1                            00000001
IOCAN2                            00000002
IOCAN3                            00000003
IOCAN4                            00000004
IOCAN5                            00000005
IOCAP                             00000391
IOCAP0                            00000000
IOCAP1                            00000001
IOCAP2                            00000002
IOCAP3                            00000003
IOCAP4                            00000004
IOCAP5                            00000005
IOCIE                             00000003
IOCIF                             00000000
IRCF0                             00000003
IRCF1                             00000004
IRCF2                             00000005
IRCF3                             00000006
IRQ_2                             0000001B
IRQ_5                             0000001E
IRQ_5_End                         00000026
ISR_Temp                          00000020
Init_I2C                          00000031
MPASM 5.64  /PROJECTS/I2CTEST/TESTI2CSLAVE.A   11-9-2015  15:32:32         PAGE 31

F1822 Macros
SYMBOL TABLE
  LABEL                             VALUE 

Init_I2C_L1                       00000039
Init_I2C_L2                       00000043
LATA                              0000010C
LATA0                             00000000
LATA1                             00000001
LATA2                             00000002
LATA4                             00000004
LATA5                             00000005
LED1Bit                           LATA,5
LEDErrorTime                      0000000A
LEDTIME                           00000064
LED_Time                          00000021
LFIOFR                            00000001
LOADFSR0                          
LOADFSR1                          
LWLO                              00000005
MC1OUT                            00000000
MDBIT                             00000000
MDCARH                            0000039F
MDCARL                            0000039E
MDCH0                             00000000
MDCH1                             00000001
MDCH2                             00000002
MDCH3                             00000003
MDCHODIS                          00000007
MDCHPOL                           00000006
MDCHSYNC                          00000005
MDCIN1                            00000002
MDCIN2                            00000004
MDCL0                             00000000
MDCL1                             00000001
MDCL2                             00000002
MDCL3                             00000003
MDCLODIS                          00000007
MDCLPOL                           00000006
MDCLSYNC                          00000005
MDCON                             0000039C
MDEN                              00000007
MDMIN                             00000001
MDMS0                             00000000
MDMS1                             00000001
MDMS2                             00000002
MDMS3                             00000003
MDMSODIS                          00000007
MDOE                              00000006
MDOPOL                            00000004
MDOUT_MDCON                       00000003
MDOUT_PORTA                       00000000
MDSLR                             00000005
MDSRC                             0000039D
MFIOFR                            00000002
MainLoop                          000000DA
NOT_BOR                           00000000
MPASM 5.64  /PROJECTS/I2CTEST/TESTI2CSLAVE.A   11-9-2015  15:32:32         PAGE 32

F1822 Macros
SYMBOL TABLE
  LABEL                             VALUE 

NOT_DONE                          00000001
NOT_MCLR                          00000003
NOT_PD                            00000003
NOT_POR                           00000001
NOT_RI                            00000002
NOT_RMCLR                         00000003
NOT_T1SYNC                        00000002
NOT_TO                            00000004
NOT_WPUEN                         00000007
NO_MEM_OVERWRITE                  000000B2
OERR                              00000001
OPTION_REG                        00000095
OSC1                              00000005
OSC2                              00000004
OSCCON                            00000099
OSCSTAT                           0000009A
OSCTUNE                           00000098
OSFIE                             00000007
OSFIF                             00000007
OSTS                              00000005
P                                 00000004
P1BSEL                            00000001
P1DC0                             00000000
P1DC1                             00000001
P1DC2                             00000002
P1DC3                             00000003
P1DC4                             00000004
P1DC5                             00000005
P1DC6                             00000006
P1M0                              00000006
P1M1                              00000007
P1RSEN                            00000007
PCIE                              00000006
PCL                               00000002
PCLATH                            0000000A
PCLATH_SHAD                       00000FE7
PCON                              00000096
PEIE                              00000006
PEN                               00000002
PIE1                              00000091
PIE2                              00000092
PIR1                              00000011
PIR2                              00000012
PLLR                              00000006
PORTA                             0000000C
PR2                               0000001B
PS0                               00000000
PS1                               00000001
PS2                               00000002
PSA                               00000003
PSS1AC0                           00000002
PSS1AC1                           00000003
PSS1BD0                           00000000
MPASM 5.64  /PROJECTS/I2CTEST/TESTI2CSLAVE.A   11-9-2015  15:32:32         PAGE 33

F1822 Macros
SYMBOL TABLE
  LABEL                             VALUE 

PSS1BD1                           00000001
PSTR1CON                          00000296
PWM1CON                           00000294
Param70                           00000070
Param71                           00000071
Param76                           00000076
Param77                           00000077
Param78                           00000078
Param79                           00000079
Param7A                           0000007A
Param7B                           0000007B
Param7C                           0000007C
Param7D                           0000007D
Param7E                           0000007E
Param7F                           0000007F
PortADDRBits                      000000CF
PortAValue                        00000000
RA0                               00000000
RA1                               00000001
RA2                               00000002
RA3                               00000003
RA4                               00000004
RA5                               00000005
RCEN                              00000003
RCIDL                             00000006
RCIE                              00000005
RCIF                              00000005
RCREG                             00000199
RCSTA                             0000019D
RD                                00000000
RSEN                              00000001
RX9                               00000006
RX9D                              00000000
RXDTSEL                           00000007
RX_ELEMENTS                       00000008
R_ADDRESS                         00000063
R_Add_ACK                         00000069
R_DATA                            00000076
R_Data_NACK                       0000008C
R_NOT_W                           00000002
R_PastEnd                         00000085
S                                 00000003
SBCDE                             00000002
SBOREN                            00000007
SCIE                              00000005
SCK                               00000001
SCKP                              00000004
SCL                               00000001
SCS0                              00000000
SCS1                              00000001
SDA                               00000002
SDAHT                             00000003
SDI                               00000002
MPASM 5.64  /PROJECTS/I2CTEST/TESTI2CSLAVE.A   11-9-2015  15:32:32         PAGE 34

F1822 Macros
SYMBOL TABLE
  LABEL                             VALUE 

SDO1SEL                           00000006
SDOSEL                            00000006
SEN                               00000000
SENDB                             00000003
SKPB                              
SKPNB                             
SMP                               00000007
SP1BRG                            0000019B
SP1BRGH                           0000019C
SP1BRGL                           0000019B
SPBRG                             0000019B
SPBRGH                            0000019C
SPBRGL                            0000019B
SPEN                              00000007
SPLLEN                            00000007
SRCLK0                            00000004
SRCLK1                            00000005
SRCLK2                            00000006
SRCON0                            0000011A
SRCON1                            0000011B
SREN                              00000005
SRI                               00000001
SRLEN                             00000007
SRNQ                              00000005
SRNQEN                            00000002
SRPR                              00000000
SRPS                              00000001
SRQ                               00000002
SRQEN                             00000003
SRRC1E                            00000000
SRRCKE                            00000002
SRRPE                             00000003
SRSC1E                            00000004
SRSCKE                            00000006
SRSPE                             00000007
SS1SEL                            00000005
SSP1ADD                           00000212
SSP1BUF                           00000211
SSP1CON1                          00000215
SSP1CON2                          00000216
SSP1CON3                          00000217
SSP1IE                            00000003
SSP1IF                            00000003
SSP1MSK                           00000213
SSP1STAT                          00000214
SSPADD                            00000212
SSPBUF                            00000211
SSPCON                            00000215
SSPCON1                           00000215
SSPCON2                           00000216
SSPCON3                           00000217
SSPEN                             00000005
SSPM0                             00000000
MPASM 5.64  /PROJECTS/I2CTEST/TESTI2CSLAVE.A   11-9-2015  15:32:32         PAGE 35

F1822 Macros
SYMBOL TABLE
  LABEL                             VALUE 

SSPM1                             00000001
SSPM2                             00000002
SSPM3                             00000003
SSPMSK                            00000213
SSPOV                             00000006
SSPSTAT                           00000214
SSSEL                             00000005
STATUS                            00000003
STATUS_SHAD                       00000FE4
STKOVF                            00000007
STKPTR                            00000FED
STKUNF                            00000006
STR1A                             00000000
STR1B                             00000001
STR1C                             00000002
STR1D                             00000003
STR1SYNC                          00000004
SUBBF                             
SW1BtnBit                         PORTA,3
SWDTEN                            00000000
SYNC                              00000004
SysFlags                          0000002E
SysLEDTrisBit                     TRISA,4
SystemBlinkDone                   00000018
SystemBlink_end                   0000001B
SystemLED                         LATA,4
T0CKI                             00000002
T0CS                              00000005
T0IE                              00000005
T0IF                              00000002
T0SE                              00000004
T0XCS                             00000000
T1CKI                             00000005
T1CKPS0                           00000004
T1CKPS1                           00000005
T1CON                             00000018
T1CON_Val                         00000001
T1GCON                            00000019
T1GGO                             00000003
T1GGO_NOT_DONE                    00000003
T1GPOL                            00000006
T1GSEL                            00000003
T1GSPM                            00000004
T1GSS0                            00000000
T1GSS1                            00000001
T1GTM                             00000005
T1GVAL                            00000002
T1OSCEN                           00000003
T1OSCR                            00000007
T1OSI                             00000005
T1OSO                             00000004
T2CKPS0                           00000000
T2CKPS1                           00000001
MPASM 5.64  /PROJECTS/I2CTEST/TESTI2CSLAVE.A   11-9-2015  15:32:32         PAGE 36

F1822 Macros
SYMBOL TABLE
  LABEL                             VALUE 

T2CON                             0000001C
T2OUTPS0                          00000003
T2OUTPS1                          00000004
T2OUTPS2                          00000005
T2OUTPS3                          00000006
TMR0                              00000015
TMR0CS                            00000005
TMR0IE                            00000005
TMR0IF                            00000002
TMR0SE                            00000004
TMR0Val                           000000B2
TMR1                              00000016
TMR1CS0                           00000006
TMR1CS1                           00000007
TMR1GE                            00000007
TMR1GIE                           00000007
TMR1GIF                           00000007
TMR1H                             00000017
TMR1IE                            00000000
TMR1IF                            00000000
TMR1L                             00000016
TMR1ON                            00000000
TMR2                              0000001A
TMR2IE                            00000001
TMR2IF                            00000001
TMR2ON                            00000002
TOSH                              00000FEF
TOSL                              00000FEE
TRISA                             0000008C
TRISA0                            00000000
TRISA1                            00000001
TRISA2                            00000002
TRISA3                            00000003
TRISA4                            00000004
TRISA5                            00000005
TRMT                              00000001
TSEN                              00000005
TSRNG                             00000004
TUN0                              00000000
TUN1                              00000001
TUN2                              00000002
TUN3                              00000003
TUN4                              00000004
TUN5                              00000005
TX9                               00000006
TX9D                              00000000
TXCKSEL                           00000002
TXEN                              00000005
TXIE                              00000004
TXIF                              00000004
TXREG                             0000019A
TXSTA                             0000019E
TX_DataSize                       00000073
MPASM 5.64  /PROJECTS/I2CTEST/TESTI2CSLAVE.A   11-9-2015  15:32:32         PAGE 37

F1822 Macros
SYMBOL TABLE
  LABEL                             VALUE 

TX_ELEMENTS                       00000008
TestT1_Zero                       00000131
TestT2_Zero                       0000012E
TestT3_Zero                       0000012B
TestT4_Zero                       00000128
TestTimerIsZero                   
Timer1Hi                          00000027
Timer1Lo                          00000026
Timer2Hi                          00000029
Timer2Lo                          00000028
Timer3Hi                          0000002B
Timer3Lo                          0000002A
Timer4Hi                          0000002D
Timer4Lo                          0000002C
TimerI2C                          00000026
ToggleSysLED                      00000027
UA                                00000001
UesesCopyToRam                    00000000
W                                 00000000
WCOL                              00000007
WDTCON                            00000097
WDTPS0                            00000001
WDTPS1                            00000002
WDTPS2                            00000003
WDTPS3                            00000004
WDTPS4                            00000005
WPUA                              0000020C
WPUA0                             00000000
WPUA1                             00000001
WPUA2                             00000002
WPUA3                             00000003
WPUA4                             00000004
WPUA5                             00000005
WR                                00000001
WREG                              00000009
WREG_SHAD                         00000FE5
WREN                              00000002
WRERR                             00000003
WUE                               00000001
W_ACK                             00000094
W_ADDRESS                         00000090
W_DATA                            00000096
W_Data_Stop                       000000B0
Z                                 00000002
Z_SHAD                            00000002
_BOREN_NSLEEP                     0000FDFF
_BOREN_OFF                        0000F9FF
_BOREN_ON                         0000FFFF
_BOREN_SBODEN                     0000FBFF
_BORV_19                          0000FFFF
_BORV_HI                          0000FBFF
_BORV_LO                          0000FFFF
_C                                STATUS,C
MPASM 5.64  /PROJECTS/I2CTEST/TESTI2CSLAVE.A   11-9-2015  15:32:32         PAGE 38

F1822 Macros
SYMBOL TABLE
  LABEL                             VALUE 

_CLKOUTEN_OFF                     0000FFFF
_CLKOUTEN_ON                      0000F7FF
_CONFIG1                          00008007
_CONFIG2                          00008008
_CPD_OFF                          0000FFFF
_CPD_ON                           0000FEFF
_CP_OFF                           0000FFFF
_CP_ON                            0000FF7F
_DEVID1                           00008006
_FCMEN_OFF                        0000DFFF
_FCMEN_ON                         0000FFFF
_FOSC_ECH                         0000FFFF
_FOSC_ECL                         0000FFFD
_FOSC_ECM                         0000FFFE
_FOSC_EXTRC                       0000FFFB
_FOSC_HS                          0000FFFA
_FOSC_INTOSC                      0000FFFC
_FOSC_LP                          0000FFF8
_FOSC_XT                          0000FFF9
_IDLOC0                           00008000
_IDLOC1                           00008001
_IDLOC2                           00008002
_IDLOC3                           00008003
_IESO_OFF                         0000EFFF
_IESO_ON                          0000FFFF
_LVP_OFF                          0000DFFF
_LVP_ON                           0000FFFF
_MCLRE_OFF                        0000FFBF
_MCLRE_ON                         0000FFFF
_PLLEN_OFF                        0000FEFF
_PLLEN_ON                         0000FFFF
_PWRTE_OFF                        0000FFFF
_PWRTE_ON                         0000FFDF
_STVREN_OFF                       0000FDFF
_STVREN_ON                        0000FFFF
_WDTE_NSLEEP                      0000FFF7
_WDTE_OFF                         0000FFE7
_WDTE_ON                          0000FFFF
_WDTE_SWDTEN                      0000FFEF
_WRT_ALL                          0000FFFC
_WRT_BOOT                         0000FFFE
_WRT_HALF                         0000FFFD
_WRT_OFF                          0000FFFF
_Z                                STATUS,Z
__12F1822                         00000001
kWDTime                           000000C8
lastc                             00000022
oldCode                           00000000
start                             000000B4
tickcount                         00000023
useI2CISR                         00000001
useI2CWDT                         00000001
useRS232                          00000000
MPASM 5.64  /PROJECTS/I2CTEST/TESTI2CSLAVE.A   11-9-2015  15:32:32         PAGE 39

F1822 Macros




Errors   :     0
Warnings :     0 reported,     0 suppressed
Messages :    69 reported,     0 suppressed

